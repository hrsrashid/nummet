module SodeRungeKuttaSpec where

import qualified Data.Matrix    as Mx
import qualified Data.Vector    as Vec
import           Function
import           Library
import qualified SodeRungeKutta
import           Test.Hspec
import           TestLib


suite :: SpecWith ()
suite =
  describe "SodeRungeKutta" $ do
    let compute = fmap Mx.toLists . SodeRungeKutta.compute . Mx.fromLists

    it "solve y' = {1, 2x}; y(0) = {0, 0}" $
      compute
        [ [simpleFunc "1"  (Right . const 1), simpleFunc "0" (Right . const 0)]
        , [simpleFunc "2x" (Right . (2*)),    simpleFunc "0" (Right . const 0)]
        ] `shouldBe` Right
        [ [1, 1, 1]
        , [1.1, 1.1, 1.21]
        , [1.2, 1.2, 1.44]
        , [1.3, 1.3, 1.69]
        , [1.4, 1.4, 1.96]
        , [1.5, 1.5, 2.25]
        , [1.6, 1.6, 2.56]
        , [1.7, 1.7, 2.89]
        , [1.8, 1.8, 3.24]
        , [1.9, 1.9, 3.61]
        , [2.0, 2.0, 4.0]
        , [2.1, 2.1, 4.41]
        , [2.2, 2.2, 4.84]
        , [2.3, 2.3, 5.29]
        , [2.4, 2.4, 5.76]
        , [2.5, 2.5, 6.25]
        , [2.6, 2.6, 6.76]
        , [2.7, 2.7, 7.29]
        , [2.8, 2.8, 7.84]
        , [2.9, 2.9, 8.41]
        , [3.0, 3.0, 9.0]
        , [3.1, 3.1, 9.61]
        , [3.2, 3.2, 10.24]
        , [3.3, 3.3, 10.89]
        , [3.4, 3.4, 11.56]
        , [3.5, 3.5, 12.25]
        , [3.6, 3.6, 12.96]
        , [3.7, 3.7, 13.69]
        , [3.8, 3.8, 14.44]
        , [3.9, 3.9, 15.21]
        , [4.0, 4.0, 16.0]
        , [4.1, 4.1, 16.81]
        , [4.2, 4.2, 17.64]
        , [4.3, 4.3, 18.49]
        , [4.4, 4.4, 19.36]
        , [4.5, 4.5, 20.25]
        , [4.6, 4.6, 21.16]
        , [4.7, 4.7, 22.09]
        , [4.8, 4.8, 23.04]
        , [4.9, 4.9, 24.01]
        , [5.0, 5.0, 25.0]
        , [5.1, 5.1, 26.01]
        , [5.2, 5.2, 27.04]
        , [5.3, 5.3, 28.09]
        , [5.4, 5.4, 29.16]
        , [5.5, 5.5, 30.25]
        , [5.6, 5.6, 31.36]
        , [5.7, 5.7, 32.49]
        , [5.8, 5.8, 33.64]
        , [5.9, 5.9, 34.81]
        , [6.0, 6.0, 36.0]
        , [6.1, 6.1, 37.21]
        , [6.2, 6.2, 38.44]
        , [6.3, 6.3, 39.69]
        , [6.4, 6.4, 40.96]
        , [6.5, 6.5, 42.25]
        , [6.6, 6.6, 43.56]
        , [6.7, 6.7, 44.89]
        , [6.8, 6.8, 46.24]
        , [6.9, 6.9, 47.61]
        , [7.0, 7.0, 49.0]
        , [7.1, 7.1, 50.41]
        , [7.2, 7.2, 51.84]
        , [7.3, 7.3, 53.29]
        , [7.4, 7.4, 54.76]
        , [7.5, 7.5, 56.25]
        , [7.6, 7.6, 57.76]
        , [7.7, 7.7, 59.29]
        , [7.8, 7.8, 60.84]
        , [7.9, 7.9, 62.41]
        , [8.0, 8.0, 64.0]
        , [8.1, 8.1, 65.61]
        , [8.2, 8.2, 67.24]
        , [8.3, 8.3, 68.89]
        , [8.4, 8.4, 70.56]
        , [8.5, 8.5, 72.25]
        , [8.6, 8.6, 73.96]
        , [8.7, 8.7, 75.69]
        , [8.8, 8.8, 77.44]
        , [8.9, 8.9, 79.21]
        , [9.0, 9.0, 81.0]
        , [9.1, 9.1, 82.81]
        , [9.2, 9.2, 84.64]
        , [9.3, 9.3, 86.49]
        , [9.4, 9.4, 88.36]
        , [9.5, 9.5, 90.25]
        , [9.6, 9.6, 92.16]
        , [9.7, 9.7, 94.09]
        , [9.8, 9.8, 96.04]
        , [9.9, 9.9, 98.01]
        , [10.0, 10.0, 100.0]
        ]
